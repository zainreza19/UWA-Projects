---
title: "Project 2"
author: "ZAIN REZA HASAN - 24077182; BENJAMIN JOVEL - 23995719"
date: "2023-10-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Importing Datasets}

gdp_data = read.csv("GDP.csv")

yt_data = read.csv("Global YouTube Statistics (1).csv")

int_data = read.csv("internet_usage.csv")
```

```{r Joining}

#Joining YT data and GDP data of 2022
m2 <- merge(yt_data,gdp_data,by.x = 'Country',by.y='Country.Name')
m2

m2 <- merge(m2,int_data, by.x ='Country', by.y = 'Country.or.Area')
m2

#Renaming the Columns
library(dplyr)
m2 <- m2 %>% 
  rename(GDP_2022=X2022)

```
```{r}

# Removing the irrelavant columns from the dataframe

m2$rank <- NULL
m2$Youtuber <- NULL
m2$Title <- NULL
m2$Abbreviation <- NULL
m2$created_month <- NULL
m2$Country.Code <- NULL
m2$x <- NULL

# subsetting the columns that are numerical to plot a correlation

# Assuming df is your dataframe
numeric_cols <- m2[sapply(m2, is.numeric)]

options(scipen = 999)









# # Check if the 'youtuber' column has unique values
# if (!anyDuplicated(m1$youtuber) == 0) {
# print("The 'youtuber' column has unique values.")
# } else {
# print("The 'youtuber' column does not have unique values.")
# }

```

```{r}
install.packages("skimr")
library(skimr)
skim(m2)
```
```{r Removing for Coorelation}

corr_clean <- na.omit(numeric_cols)
skim(corr_clean)


```

```{r}
install.packages("corrplot")  
library(corrplot)

correlation_matrix <- cor(corr_clean)
#print(correlation_matrix)
corrplot(correlation_matrix, method = "color",tl.cex = 0.7)


```


```{r Removing Columns based on high coorelation}
#Removing since all of them are correlated | lowest_monthly_earnings, highest_monthly_earnings lowest_yearly_earnings

library(dplyr)
m2 <- m2 %>%
  select(-lowest_monthly_earnings,-highest_monthly_earnings,-lowest_yearly_earnings)

# Finding out the median for earnings inorder to classify it as "High" and "Low"
```


```{r Finding the median of Earnings}


# Find the median of the 'highest_yearly_earnings' column
median_value <- median(m2$highest_yearly_earnings)

# Print the median value
print(median_value)

# Create a new binary column 'earnings_binary' based on the median
m2$earnings_binary <- ifelse(m2$highest_yearly_earnings > median_value, 1, 0)

# Print the updated dataset
print(m2)




```
































